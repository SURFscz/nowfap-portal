---
# playbook to install and configure general components of a VOPaaS machine
#

- hosts:
  - portal
  become_user: root
  become: True

  roles:
    - { role: common,       tags: common       }
    - { role: auth_mellon,  tags: auth_mellon  }
    - { role: php,          tags: php          }
    - { role: apache,       tags: apache       }
    - { role: surfconext,   tags: surfconext   }
    - { role: mysql,        tags: mysql        }
    - { role: comanage,     tags: comanage     }

- hosts:
  - ldap-server
  become_user: root
  become: True

  roles:
    - { role: ldap, tags: ldap }

- hosts:
  - phpldapadmin
  become_user: root
  become: True

  roles:
    - { role: phpldapadmin, tags: phpldapadmin }

- hosts:
  - ssh-access
  become_user: root
  become: True

  roles:
    - { role: sshd, tags: sshd }
